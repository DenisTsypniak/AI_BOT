{% extends "base.html" %}

{% block title %}–ü–∞–º'—è—Ç—å - Live Role Bot{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">–í–∏—Ç—è–≥–Ω—É—Ç–∞ –ü–∞–º'—è—Ç—å</h1>
    <p class="page-description">–î–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤—ñ —Ñ–∞–∫—Ç–∏ —Ç–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ —Ä–æ–∑–º–æ–≤–Ω—ñ –µ–ø—ñ–∑–æ–¥–∏, –≤–∏—Ç—è–≥–Ω—É—Ç—ñ LLM.</p>
</div>

<h2 style="margin-top: 0;">–ï–ø—ñ–∑–æ–¥–∏—á–Ω–∞ –ü–∞–º'—è—Ç—å</h2>
<div class="table-container">
    <table>
        <thead>
            <tr>
                <th style="width: 60px;">ID</th>
                <th style="width: 200px;">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞ –¢–µ–º–∞</th>
                <th>–ö–æ—Ä–æ—Ç–∫–∏–π –∑–º—ñ—Å—Ç –ï–ø—ñ–∑–æ–¥—É</th>
                <th style="width: 80px;">–°—Ç–∞—Ç—É—Å</th>
                <th style="width: 80px;">–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å</th>
                <th style="width: 120px;">–û–Ω–æ–≤–ª–µ–Ω–æ</th>
                <th>–î—ñ—ó</th>
            </tr>
        </thead>
        <tbody>
            {% for ep in episodes %}
            <tr>
                <td style="color: var(--text-muted); font-size: 0.85rem;">#{{ ep.episode_id }}</td>
                <td>
                    <strong>{{ ep.title }}</strong>
                    <div
                        style="font-size: 0.75rem; color: var(--text-muted); margin-top: 4px; text-transform: uppercase;">
                        –¢–ò–ü: {{ ep.episode_type }}</div>
                </td>
                <td class="text-wrap" style="color: var(--text-muted); font-size: 0.9rem;">{{ ep.summary }}</td>
                <td>
                    {% if ep.status == 'confirmed' %}
                    <span class="badge green">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ</span>
                    {% elif ep.status == 'candidate' %}
                    <span class="badge yellow">–ö–∞–Ω–¥–∏–¥–∞—Ç</span>
                    {% else %}
                    <span class="badge">{{ ep.status }}</span>
                    {% endif %}
                </td>
                <td>
                    <div
                        class="font-weight-bold {% if ep.importance > 0.7 %}text-red{% elif ep.importance > 0.4 %}text-yellow{% else %}text-green{% endif %}">
                        {{"%.2f"|format(ep.importance)}}
                    </div>
                </td>
                <td style="color: var(--text-muted); font-size: 0.85rem;">{{ ep.updated_at|kyiv_time }}</td>
                <td>
                    <a href="/memory/episodes/{{ ep.episode_id }}" class="btn"
                        style="padding: 4px 8px; font-size: 0.8rem;">–î–µ—Ç.</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="7" style="text-align: center; padding: 30px; color: var(--text-muted);">–ï–ø—ñ–∑–æ–¥—ñ–≤
                    —â–µ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω–æ. –ó—Ä–æ—Å—Ç–∞–Ω–Ω—è –ø–µ—Ä—Å–æ–Ω–∏ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–æ –∞–±–æ —É–≤—ñ–º–∫–Ω–µ–Ω–æ shadow mode.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<h2 style="margin-top: 40px;">–§–∞–∫—Ç–∏ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</h2>
<div class="table-container">
    <table>
        <thead>
            <tr>
                <th style="width: 150px;">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á</th>
                <th style="width: 120px;">–ö–ª—é—á –§–∞–∫—Ç—É</th>
                <th>–ó–Ω–∞—á–µ–Ω–Ω—è –§–∞–∫—Ç—É</th>
                <th style="width: 80px;">–°—Ç–∞—Ç—É—Å</th>
                <th style="width: 80px;">–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å</th>
                <th style="width: 120px;">–û–Ω–æ–≤–ª–µ–Ω–æ</th>
            </tr>
        </thead>
        <tbody>
            {% for fact in facts %}
            <tr>
                <td>
                    <strong>{{ fact.discord_username or '–ù–µ–≤—ñ–¥–æ–º–æ' }}</strong>
                    <div style="font-size: 0.75rem; color: var(--text-muted); font-family: monospace;">{{ fact.user_id
                        }}</div>
                </td>
                <td><span class="badge"
                        style="background-color: var(--surface-color); border: 1px solid var(--border-color);">{{
                        fact.fact_key }}</span></td>
                <td class="text-wrap" style="font-size: 0.95rem;">{{ fact.fact_value }}
                    {% if fact.pinned %}
                    <span title="–ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –§–∞–∫—Ç" style="cursor: help;">üìå</span>
                    {% endif %}
                </td>
                <td>
                    {% if fact.status == 'active' %}
                    <span class="badge green">–ê–∫—Ç–∏–≤–Ω–∏–π</span>
                    {% elif fact.status == 'recalled' %}
                    <span class="badge blue">–ó–≥–∞–¥–∞–Ω–∏–π</span>
                    {% else %}
                    <span class="badge">{{ fact.status }}</span>
                    {% endif %}
                </td>
                <td>
                    <div
                        class="font-weight-bold {% if fact.importance > 0.7 %}text-red{% elif fact.importance > 0.4 %}text-yellow{% else %}text-green{% endif %}">
                        {{"%.2f"|format(fact.importance)}}
                    </div>
                </td>
                <td style="color: var(--text-muted); font-size: 0.85rem;">{{ fact.updated_at|kyiv_time }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" style="text-align: center; padding: 30px; color: var(--text-muted);">–§–∞–∫—Ç—ñ–≤ —â–µ –Ω–µ
                    –≤–∏—Ç—è–≥–Ω—É—Ç–æ.
                    –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –∞–∫—Ç–∏–≤–Ω–∏–π –º–æ–¥—É–ª—å Mem0/Memory.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}